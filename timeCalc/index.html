<!DOCTYPE html>
<html>
<head>
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-G3VRHWGPB7"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'G-G3VRHWGPB7');
	</script>

	<base href="/MyAllFiles/">

	<title>Time Calculator</title>
	<link rel="icon" href="0_data/images/ageCalc_icon.svg">
	<style>
		@font-face {
			font-family: "titleFont";
			src: url("0_data/fonts//kazesawa-Regular.ttf");
		}

		@font-face {
			font-family: "originalFont";
			src: url("0_data/fonts//simpleFont3-regular.ttf");
		}

		.inValid {
			background-color: #fcc;
			color: #f00;
			border-radius: 3px;
		}

		* {font-family: "originalFont";}

		body {margin: 0;}

		input {
			border: .5px solid #666;
			border-radius: 3px;
		}

		fieldset:not(#inputField>fieldset) {
			border: 1px solid #444;
			border-radius: 10px;
		}

		span[lang="en"] {
			font-size: 13px;
			
			&:not(#inputLabel>th>span:nth-of-type(2)) {
				margin-left: 2px;
			}
		}

		#title {
			font-family: "titleFont";
			display: inline-block;
			padding: 5px 10px;
			margin: 0;
			border-bottom-right-radius: 10px;
			background: linear-gradient(60deg, #aef, #eaf);
		}

		#inputField {margin: 30px 20px;}

		#inputField>fieldset {
			border: none;
			border-radius: 5px;;
		}

		#inputField>fieldset>legend {
			padding: 2px 8px;
			border-radius: 5px;
		}

		#inputDateTime {background-color: #d0f0ff;}

		#inputDateTime input[type="number"] {width: 53px;}

		#inputDateTime input[type="radio"] {width: 25px;}

		#inputDateTime>legend {background-color: #adf;}

		#inputDateTime th {font-weight: normal;}

		#inputLabel {height: 1em;}

		#inputLabel>th {position: relative;}

		input[name="BC/AD"]+span {white-space: nowrap;}

		#inputLabel>td>label {
			white-space: nowrap;
			display: inline-block;
			width: 60px;
		}

		#inputLabel>td>label>span {
			position: relative;

			&:nth-of-type(1) {
				right: 1.5px;
			}
			&:nth-of-type(2) {
				left: 1.5px;
			}
		}

		#inputDateTime td>input {width: 50px;}

		#inputDateTime td>span {
			font-size: 25px;
			translate: 0 -6px;
		}

		#otherInput {background-color: #ffffda}

		#otherInput>legend {background-color: #fea;}

		#otherInput input:not(input[type="radio"]) {
			margin-left: 15px;
			width: 100px; /* 要素によって変わります */
		}

		#otherInput #leftTopText {width: 200px;}

		label:has(input[name="rounding"]) {
			display: inline-block;
			width: 220px;
			padding: 2px 5px;
			border: 1px solid #666;
			border-radius: 5px;
			background-color: #ab8;
		}

		label:has(input[name="rounding"]:checked) {
			background-color: #cfa;
		}

		input[name="rounding"] {display: none;}

		input[name="rounding"]+img {
			margin-bottom: -10px;
			translate: 0 -2.5px;
		}
	</style>
</head>
<body>
	<h1 id="title">Time Calculator</h1>
	<span id="version"></span>
	<fieldset id="inputField">
		<legend>入力欄
			<span lang="en">Input field</span>
		</legend>
		<fieldset id="inputDateTime">
			<legend>年月日と時間</legend>
			<table>
				<tr id="inputLabel">
					<th style="padding-right: 20px">
						<label>
							<input type="radio" name="BC/AD" value="BC">
							<span>紀元前
								<span lang="en">BC</span>
							</span>
						</label>
						<br>
						<label>
							<input type="radio" name="BC/AD" value="AD">
							<span>紀元後
								<span lang="en">AD</span>
							</span>
						</label>
					</th>
					<td>
						<label>
							<span>年</span>
							<span lang="en">Year</span>
							<br>
							<input type="number" id="year" placeholder="2000" min="1" step="1">
						</label>
						<span>/</span>
							<label>
								<span>月</span>
								<span lang="en">Month</span>
								<br>
								<input type="number" id="month" placeholder="1" min="1" max="12" step="1">
							</label>
						<span>/</span>
						<label>
							<span>日</span>
							<span lang="en">Day</span>
							<br>
							<input type="number" id="day" placeholder="1" min="1" max="31" step="1">
						</label>
						<span>/</span>
						<label>
							<span>時</span>
							<span lang="en">Hour</span>
							<br>
							<input type="number" id="hour" placeholder="0" min="0" max="23" step="1">
						</label>
						<span>:</span>
						<label>
							<span>分</span>
							<span lang="en">Min</span>
							<br>
							<input type="number" id="min" placeholder="0" min="0" max="59" step="1">
						</label>
						<span>:</span>
						<label>
							<span>秒</span>
							<span lang="en">Sec</span>
							<br>
							<input type="number" id="sec" placeholder="0" min="0" max="59" step="1">
						</label>
					</td>
				</tr>
			</table>
		</fieldset>
		<br>
		<fieldset id="otherInput">
			<legend>表示
				<span lang="en">Display Settings</span>
			</legend>
			<fieldset>
				<legend>つける文字</legend>
				<label>タイトル
					<span lang="en">Title</span>
					<input id="titleText" placeholder="例) 生まれてから">
				</label>
				<br>
				<label>前置
					<span lang="en">Before-text</span>
					<input id="beforeText" placeholder="例) 約">
				</label>
				<br>
				<label>後置
					<span lang="en">After-text</span>
					<input id="afterText" placeholder="例) 年">
				</label>
			</fieldset>
			<fieldset>
				<legend>数字
					<span lang="en">Number Settings</span>
				</legend>
				<label>小数点以下の桁数
					<span lang="en">Decimal places</span>
					<input type="number" id="decimalPlace" placeholder="3" min="0" step="1" style="width: 50px;">
				</label>
				<br>
				表示桁数未満の丸め処理の方法
				<span lang="en">How to handle numbers below the display limit</span>
				<br>
				<label>
					<input type="radio" name="rounding" value="roundOff" checked>
					<img src="0_data/images/roundDown.svg" width="30px">
				切り捨て / Round down</label>
				<br>
				<label>
					<input type="radio" name="rounding" value="roundUp">
					<img src="0_data/images/roundOff.svg" width="30px">
				四捨五入 / Round off</label>
				<br>
				<label>
					<input type="radio" name="rounding" value="roundDown">
					<img src="0_data/images/roundUp.svg" width="30px">
				切り上げ / Round up</label>
			</fieldset>
		</fieldset>
	</fieldset>
	<script>
		let isValid = {
			all: true,
			year: true,
			month: true,
			day: true,
			hour: true,
			min: true,
			sec: true
		};
		/** この関数は、入力したIDを持つHTMLドキュメント内の要素を取得します。このJSプログラムで基本的な要素を担っています。
		 * @param {string} id 取得したい要素のID
		 * @return {HTMLElement} 指定されたIDを持つ要素
		 */
		function el(id) {return document.getElementById(id)};
		/** この関数は、変数isValidを更新するためのものです。主にinputLimiter関数で使われています。 */
		function validUpdate() {
			for (const key in Object.keys(isValid)) {
				if(key === "all") {
					isValid[key] = true;
				} else if(isValid[key] = false) {
					isValid.all = false;
				};
			};
		};
		/** この関数は、入力欄(Input Field)に入力された数値が有効かどうかを判定し、有効でなければその要素にCSSのclassを付与して有効でない値であることをユーザーに伝えます。
		 * @param {string} id 判定したい要素のID
		 */
		function inputLimiter(id) {
			el(id).addEventListener("input",function() {
				const value = this.value;
				if(value == "") {
					isValid[id] = true;
				} else if((value < Number(this.min) && this.min != "") || (value > Number(this.max) && this.max != "") || (value % Number(this.step) != 0)) {
					isValid[id] = false;
					this.classList.add("inValid");
				} else {
					isValid[id] = true;
					this.classList.remove("inValid");
				};
				if(value == "") {
					isValid[id] = true;
					this.classList.remove("inValid");
				};
			});
		};
		inputLimiter("year");
		inputLimiter("month");
		inputLimiter("day");
		inputLimiter("hour");
		inputLimiter("min");
		inputLimiter("sec");
		inputLimiter("decimalPlace");
	</script>
</body>
</html>