<!DOCTYPE html>
<html>
<head>
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-G3VRHWGPB7"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());

		gtag('config', 'G-G3VRHWGPB7');
	</script>

	<!-- Color picker:
		I used Pickr(https://github.com/Simonwep/pickr?tab=readme-ov-file).
		A big thank you to simonwep. -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@simonwep/pickr@1.8.2/dist/themes/monolith.min.css">
	<script src="https://cdn.jsdelivr.net/npm/@simonwep/pickr@1.8.2/dist/pickr.min.js"></script>

	<title>Time Calculator</title>
	<link rel="icon" href="/0_data/images/ageCalc_icon.svg">
	<style>
		@font-face {
			font-family: "titleFont";
			src: url("/0_data/fonts//kazesawa-Regular.ttf");
		}

		@font-face {
			font-family: "originalFont";
			src: url("/0_data/fonts//simpleFont3-regular.ttf");
		}

		.inValid {
			background-color: #fcc;
			color: #f00;
			border-radius: 3px;
		}

		div:has(> .pcr-button) {
			display: inline-block;
		}
		
		.pcr-button {
			width: 25px !important;
			height: 25px !important;
		}

		* {
			font-family: "originalFont";
			font-size: 16px;
		}

		body {
			margin: 0;
			overflow-x: hidden;
		}

		h1 {font-size: 30px;}

		input {
			border: .5px solid #666;
			border-radius: 3px;
		}

		span[lang="en"] {
			font-size: 13px;
			
			&:not(#doDisplayEnglish~span) {
				display: none;
			}
			
			&:not(#inputLabel>th>span:nth-of-type(2)) {
				margin-left: 2px;
			}
		}

		#title {
			font-family: "titleFont";
			display: inline-block;
			padding: 5px 10px;
			margin: 0;
			border-bottom-right-radius: 10px;
			background: linear-gradient(60deg, #aef, #eaf);
		}

		#outputParent {
			position: relative;
			width: calc(100vw - 20px);
			height: 85vh;
			background-image: linear-gradient(315deg,#aaf,#cae,#aaf);
			margin: auto 10px;
			margin-top: 20px;
		}

		#outputParent>* {position: absolute;}

		#titleOutput {
			top: 20vh;
		}

		#mainOutput {
			top: 42.5vh;
			left: calc(50vw - 10px);
			translate: -50% -50%;
			white-space: nowrap;
		}

		#numberOutput {font-size: 70px;}

		#beforeOutput, #afterOutput {
			font-size: 42px;
		}

		#inputField {
			margin: 30px 20px;
			border: 1px solid #444;
			border-radius: 10px;
		}

		label:has(#doDisplayEnglish) {
			display: block;
			margin: 10px auto;
		}

		#inputField>fieldset {
			border: none;
			border-radius: 5px;;
		}

		#inputField>fieldset>legend {
			padding: 2px 8px;
			border-radius: 5px;
		}

		#inputDateTime {background-color: #d0f0ff;}

		#inputDateTime input[type="number"] {width: 53px;}

		#inputDateTime input[type="radio"] {width: 25px;}

		#inputDateTime>legend {background-color: #adf;}

		#inputDateTime th {font-weight: normal;}

		#inputLabel {height: 1em;}

		#inputLabel>th {position: relative;}

		input[name="BC/AD"]+span {white-space: nowrap;}

		#inputLabel>td>label {
			white-space: nowrap;
			display: inline-block;
			width: 60px;
		}

		#inputLabel>td>label>span {
			position: relative;

			&:nth-of-type(1) {
				right: 1.5px;
			}
			&:nth-of-type(2) {
				left: 1.5px;
			}
		}

		#inputDateTime td>input {width: 50px;}

		#inputDateTime td>span {
			font-size: 25px;
			translate: 0 -6px;
		}

		#otherInput {
			display: grid;
			grid-template-columns: 1fr 1fr;
			padding: 5px;
			background-color: #ffffda;
		}

		#otherInput>legend {background-color: #fea;}

		#otherInput>div {padding-top: 10px;}

		#otherInput>div>ul {
			margin: 0;
			list-style: none;
		}

		li:has(.listTitle) {
			border-image-width: 0 0 0 2px;
			border-image-slice: 0 0 0 100%;
			border-image-outset: 1 1 1 10px;
			border-image-source: linear-gradient(to bottom, transparent 2.3em, #777 2.3em);
		}

		.listTitle {
			display:inline-block;
			margin-top: 10px;
			margin-bottom: 5px;
			margin-left: -20px;
			font-size: 17px;
		}

		#otherInput input:not(input[type="radio"]) {
			margin-left: 15px;
			width: 100px; /* è¦ç´ ã«ã‚ˆã£ã¦å¤‰ã‚ã‚Šã¾ã™ */
		}

		#otherInput #titleText {width: 200px;}

		label:has(input[name="rounding"]) {
			display: inline-flex;
			align-items: center;
			width: 220px;
			padding: 2px 5px;
			border-radius: 5px;
			margin: 1px auto;
		}

		label:has(input[name="rounding"]:checked) {
			color: #0be
		}

		label:has(input[name="rounding"])>span {
			margin-left: 5px;
		}
	</style>
</head>
<body>
	<h1 id="title">Time Calculator</h1>
	<span id="version">version 0.0</span>
	<div id="outputParent">
		<div id="titleOutput">Title test</div>
		<div id="mainOutput">
			<span id="beforeOutput">ç´„</span>
			<span id="numberOutput">12.345</span>
			<span id="afterOutput">å¹´</span>
		</div>
	</div>
	<fieldset id="inputField">
		<legend>å…¥åŠ›æ¬„
			<span lang="en">Input field</span>
		</legend>
		<label><input type="checkbox" id="doDisplayEnglish">ğŸ‡ºğŸ‡¸è‹±èªã‚’è¡¨ç¤ºã™ã‚‹<span lang="en">Display English</span></label>
		<fieldset id="inputDateTime">
			<legend>å¹´æœˆæ—¥ã¨æ™‚é–“
				<span lang="en">Date and Time</span>
			</legend>
			<table>
				<tr id="inputLabel">
					<th style="padding-right: 20px">
						<label>
							<input type="radio" name="BC/AD" value="BC" disabled>
							<span>ç´€å…ƒå‰
								<span lang="en">B.C.</span>
							</span>
						</label>
						<br>
						<label>
							<input type="radio" name="BC/AD" value="AD" checked>
							<span>ç´€å…ƒå¾Œ
								<span lang="en">A.D.</span>
							</span>
						</label>
					</th>
					<td>
						<label style="margin-bottom: 5px;">
							<input id="autoFocus" type="checkbox" checked>
							è‡ªå‹•ã§æ¬¡ã®å…¥åŠ›æ¬„ã«ç§»ã™
							<span lang="en">Auto move to the next field</span>
						</label>
						<br>
						<label>
							<span>å¹´</span>
							<span lang="en">Year</span>
							<br>
							<input type="number" id="year" placeholder="2000" min="1" step="1">
						</label>
						<span>/</span>
							<label>
								<span>æœˆ</span>
								<span lang="en">Month</span>
								<br>
								<input type="number" id="month" placeholder="1" min="1" max="12" step="1">
							</label>
						<span>/</span>
						<label>
							<span>æ—¥</span>
							<span lang="en">Day</span>
							<br>
							<input type="number" id="day" placeholder="1" min="1" max="31" step="1">
						</label>
						<span>/</span>
						<label>
							<span>æ™‚</span>
							<span lang="en">Hour</span>
							<br>
							<input type="number" id="hour" placeholder="0" min="0" max="23" step="1">
						</label>
						<span>:</span>
						<label>
							<span>åˆ†</span>
							<span lang="en">Min</span>
							<br>
							<input type="number" id="min" placeholder="0" min="0" max="59" step="1">
						</label>
						<span>:</span>
						<label>
							<span>ç§’</span>
							<span lang="en">Sec</span>
							<br>
							<input type="number" id="sec" placeholder="0" min="0" max="59" step="1">
						</label>
					</td>
				</tr>
			</table>
		</fieldset>
		<br>
		<fieldset id="otherInput">
			<legend>è¡¨ç¤º
				<span lang="en">Display Settings</span>
			</legend>
			<div>
				<ul>
					<li><span class="listTitle">ã¤ã‘ã‚‹æ–‡å­—<span lang="en">Text Settings</span></span>
						<br>
						<label>ã‚¿ã‚¤ãƒˆãƒ«
							<span lang="en">Title</span>
							<input id="titleText" placeholder="ä¾‹) ç”Ÿã¾ã‚Œã¦ã‹ã‚‰">
						</label>
						<br>
						<label>å‰ç½®
							<span lang="en">Prefix</span>
							<input id="beforeText" placeholder="ä¾‹) ç´„">
						</label>
						<br>
						<label>å¾Œç½®
							<span lang="en">Suffix</span>
							<input id="afterText" placeholder="ä¾‹) å¹´">
						</label>
					</li>
					<li><span class="listTitle">æ•°å­—
							<span lang="en">Number Settings</span>
						</span>
						<br>
						<label>å°æ•°ç‚¹ä»¥ä¸‹ã®æ¡æ•°
							<span lang="en">Decimal places</span>
							<input type="number" id="decimalPlace" placeholder="3" min="0" step="1" style="width: 50px;">
						</label>
						<br>
						<span>è¡¨ç¤ºæ¡æ•°æœªæº€ã®ä¸¸ã‚å‡¦ç†ã®æ–¹æ³•
								<span lang="en">How to handle numbers below the display limit</span>
							<br>
							<label>
								<input type="radio" name="rounding" value="roundOff" checked>
								<img src="/0_data/images/roundDown.svg" width="30px">
								<span>åˆ‡ã‚Šæ¨ã¦
									<span lang="en">Round down</span>
								</span>
							</label>
							<br>
							<label>
								<input type="radio" name="rounding" value="roundUp">
								<img src="/0_data/images/roundOff.svg" width="30px">
								<span>å››æ¨äº”å…¥
									<span lang="en">Round off</span>
								</span>
							</label>
							<br>
							<label>
								<input type="radio" name="rounding" value="roundDown">
								<img src="/0_data/images/roundUp.svg" width="30px">
								<span>åˆ‡ã‚Šä¸Šã’<span lang="en">Round up</span></span>
							</label>
						</span>
					</li>
				</ul>
			</div>
			<div>
				<ul>
					<li><span class="listTitle">æ–‡å­—ã®è£…é£¾
						<span lang="en">Decoration of letters</span>
					</span>
						<br>
						<label>
							<span>æ–‡å­—ã®å¤§ãã•
								<span lang="en">Font size of number</span>
							</span>
							<input type="range" id="fontSizeRange" min="50" max="200" value="100" style="width: 200px;">
							<input type="number" id="fontSize" min="1" value="100" style="width: 50px;">px
						</label>
						<br>
						<span>
							<span>æ–‡å­—ã®è‰²
								<span lang="en">Font color</span>
							</span>
							<br>
							<label>
								<input type="radio" name="fontColor" value="same" checked>
								ã™ã¹ã¦åŒã˜è‰²ã«ã™ã‚‹
								<span lang="en">Use the same color for All</span>
							</label>
							<br>
							<label>
								<input type="radio" name="fontColor" value="different">
								ã‚¿ã‚¤ãƒˆãƒ«ã¨æ•°å­—ã¨å‰ç½®ï½¥å¾Œç½®ã§è‰²ã‚’åˆ†ã‘ã‚‹
								<span lang="en">Use different color for the Title, Number, Prefix/Suffix</span>
							</label>
							<br>
							<div id="sameFontColor">
								<span>è‰²ã‚’é¸æŠ
									<span lang="en">Color</span>:
								</span>
								<div id="fontColor"></div>
							</div>
							<div id="differentFontColor" style="display: none;">
								<span>ã‚¿ã‚¤ãƒˆãƒ«ã®è‰²
									<span lang="en">Title color</span>:
								</span>
								<div id="fontColorSuffix"></div>
								<br>
								<span>æ•°å­—ã®è‰²
									<span lang="en">Number color</span>:
								</span>
								<div id="fontColorNumber"></div>
								<br>
								<span>å‰ç½®ã®è‰²
									<span lang="en">Prefix/Suffix color</span>:
								</span>
								<div id="fontColorPrefix"></div>
							</div>
						</span>
					</li>
				</ul>
			</div>
		</fieldset>
	</fieldset>
	<!-- ã‚¢ã‚¤ãƒ‡ã‚¢ã€€æ•°å­—ãŒå¤‰ã‚ã‚‹ãŸã³ã«ã™ã“ã—æ•°å­—ãŸã¡ãŒå¤§ãããªã‚‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã™ã‚‹ ON/OFFã€å¤§ãããªã‚‹å‰²åˆã€æ™‚é–“ -->
	<script>
		function el(id) {return document.getElementById(id)};
		/** æ–°ã—ã„Pickrã‚’ä½œæˆã—ã¾ã™ã€‚
		 * @class
		 * @param {string} id Pickrã‚’è¨­ç½®ã™ã‚‹è¦ç´ ã®ID
		 * @param {string} defaultColor Pickrã®åˆæœŸè‰²
		 * @param {boolean} opacity é€æ˜åº¦ãƒãƒ¼ã‚’è¡¨ç¤ºã™ã‚‹ã‹ã©ã†ã‹
		 * @return {Pickr} ä½œæˆã•ã‚ŒãŸPickrã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
		 */
		function PickrClass(id, defaultColor, opacity=false) {
			const newPickr = Pickr.create({
				el: "#" + id,
				theme: "monolith",
				default: defaultColor,
				// /*
				swatches: [
					"#000000",
					"#ffffff",
					"#ff0000",
					"#00ff00",
					"#0000ff",
					"#ffff00",
					"#00ffff",
					"#ff00ff"
				],
				// */
				components: {
					// ä¸»è¦ãªãƒ‘ãƒãƒ«éƒ¨åˆ†
					preview: true,  // è‰²ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
					opacity: opacity, // é€æ˜åº¦ãƒãƒ¼
					hue: true,      // è‰²ç›¸ãƒãƒ¼

					// ä¸‹éƒ¨ã®å…¥åŠ›ãƒ»æ“ä½œéƒ¨åˆ†
					interaction: {
						hex: true,    // HEXå½¢å¼è¡¨ç¤º
						rgba: true,   // RGBAå½¢å¼è¡¨ç¤º
						input: true,  // å…¥åŠ›ãƒœãƒƒã‚¯ã‚¹
						clear: false, // ã‚¯ãƒªã‚¢ãƒœã‚¿ãƒ³
						save: true    // ä¿å­˜ãƒœã‚¿ãƒ³
					}
				}
			});
			newPickr.on("hide", instance => instance.applyColor());
			return newPickr;
		};
		const PICKR = {
			fontColor: new PickrClass("fontColor", "#000000", true),
			fontColorNumber: new PickrClass("fontColorNumber", "#000000", true),
			fontColorPrefix: new PickrClass("fontColorPrefix", "#000000", true),
			fontColorSuffix: new PickrClass("fontColorSuffix", "#000000", true)
		};
		// ã“ã“ã¾ã§Pickré–¢é€£ã®ã‚³ãƒ¼ãƒ‰

		let isValid = {
			all: true,
			year: true,
			month: true,
			day: true,
			hour: true,
			min: true,
			sec: true
		};
		const DATE_INPUT_LIST = ["year","month","day","hour","min","sec"];
		/** ã“ã®é–¢æ•°ã¯ã€å…¥åŠ›ã—ãŸIDã‚’æŒã¤HTMLãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå†…ã®è¦ç´ ã‚’å–å¾—ã—ã¾ã™ã€‚ã“ã®JSãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§åŸºæœ¬çš„ãªè¦ç´ ã‚’æ‹…ã£ã¦ã„ã¾ã™ã€‚
		 * @param {string} id å–å¾—ã—ãŸã„è¦ç´ ã®ID
		 * @return {HTMLElement} æŒ‡å®šã•ã‚ŒãŸIDã‚’æŒã¤è¦ç´ 
		 */
		function el(id) {return document.getElementById(id)};
		function nameValue(name) {
			const checkedEl = document.querySelector('input[name="' + name + '"]:checked');
			return checkedEl ? checkedEl.value : null;
		} 
		/** ã“ã®é–¢æ•°ã¯ã€å¤‰æ•°isValidã‚’æ›´æ–°ã™ã‚‹ãŸã‚ã®ã‚‚ã®ã§ã™ã€‚ä¸»ã«inputLimiteré–¢æ•°ã§ä½¿ã‚ã‚Œã¦ã„ã¾ã™ã€‚ */
		function validUpdate() {
			for (const key in Object.keys(isValid)) {
				if(key === "all") {
					isValid[key] = true;
				} else if(isValid[key] = false) {
					isValid.all = false;
				};
			};
		};
		/** ã“ã®é–¢æ•°ã¯ã€å…¥åŠ›æ¬„(Input Field)ã«å…¥åŠ›ã•ã‚ŒãŸæ•°å€¤ãŒæœ‰åŠ¹ã‹ã©ã†ã‹ã‚’åˆ¤å®šã—ã€æœ‰åŠ¹ã§ãªã‘ã‚Œã°ãã®è¦ç´ ã«CSSã®classã‚’ä»˜ä¸ã—ã¦æœ‰åŠ¹ã§ãªã„å€¤ã§ã‚ã‚‹ã“ã¨ã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ä¼ãˆã¾ã™ã€‚
		 * @param {string} id åˆ¤å®šã—ãŸã„è¦ç´ ã®ID
		 */
		function inputLimiter(id, doAllowWhiteSpace=true) {
			el(id).addEventListener("input",function() {
				const value = this.value;
				if(value == "") {
					isValid[id] = true;
				} else if((value < Number(this.min) && this.min != "") || (value > Number(this.max) && this.max != "") || (value % Number(this.step) != 0 && this.step != "")) {
					isValid[id] = false
					this.classList.add("inValid");
				} else {
					isValid[id] = true;
					this.classList.remove("inValid");
				};
				if(value == "" && doAllowWhiteSpace) {
					isValid[id] = true;
					this.classList.remove("inValid");
				} else {};
				validUpdate();
				if(el("autoFocus").checked && isValid[id] && value != "" && DATE_INPUT_LIST.indexOf(id) != -1 && ((value.length >= this.max.length && this.max != "") || (Number(value+"0") > this.max && this.max != "") || value == 0 || (this.id == "year" && value.length >= 4))) {
					const nextIndex = DATE_INPUT_LIST.indexOf(id) + 1;
					if(nextIndex < DATE_INPUT_LIST.length) {
						el(DATE_INPUT_LIST[nextIndex]).focus();
						el(DATE_INPUT_LIST[nextIndex]).select();
					} else {
						this.blur();
					};
				};
			});
		};
		inputLimiter("year");
		inputLimiter("month");
		inputLimiter("day");
		inputLimiter("hour");
		inputLimiter("min");
		inputLimiter("sec");
		inputLimiter("decimalPlace");
		inputLimiter("fontSize", false);

		el("doDisplayEnglish").addEventListener("input", function() {
			const langElements = document.querySelectorAll("span[lang='en']:not(#doDisplayEnglish~span)");
			if(this.checked) {
				langElements.forEach(function(element) {
					element.style.display = "inline";
				});
			} else {
				langElements.forEach(function(element) {
					element.style.display = "none";
				});
			};
		});

		el("fontSize").addEventListener("input", function() {
			el("fontSizeRange").value = this.value;
			el("numberOutput").style.fontSize = this.value + "px";
			el("beforeOutput").style.fontSize = this.value * 0.6 + "px";
			el("afterOutput").style.fontSize = this.value * 0.6 + "px";
		});
		el("fontSizeRange").addEventListener("input", function() {
			el("fontSize").value = this.value;
			el("numberOutput").style.fontSize = this.value + "px";
			el("beforeOutput").style.fontSize = this.value * 0.6 + "px";
			el("afterOutput").style.fontSize = this.value * 0.6 + "px";
		});
		document.getElementsByName("fontColor").forEach(function(radio) {
			radio.addEventListener("input", function() {
				const value = nameValue("fontColor");
				switch(value) {
					case "same":
						el("sameFontColor").style.display = "block";
						el("differentFontColor").style.display = "none";
						break;
					case "different":
						el("sameFontColor").style.display = "none";
						el("differentFontColor").style.display = "block";
						break;
				}
			});
		});
		// ã“ã“ã¾ã§å…¥åŠ›æ¬„é–¢é€£ã®ã‚³ãƒ¼ãƒ‰
	try {

		const DEFAULT_DATE = {
			year: 2000,
			month: 1,
			day: 1,
			hour: 0,
			min: 0,
			sec: 0
		};
		const MAX_VALUE = {
			year: Infinity,
			month: 12,
			day: 31,
			hour: 24,
			min: 60,
			sec: 60
		}
		let inputDate = {
			year: el("year").value ? el("year").value : DEFAULT_DATE.year,
			month: el("month").value ? el("month").value : DEFAULT_DATE.month,
			day: el("day").value ? el("day").value : DEFAULT_DATE.day,
			hour: el("hour").value ? el("hour").value : DEFAULT_DATE.hour,
			min: el("min").value ? el("min").value : DEFAULT_DATE.min,
			sec: el("sec").value ? el("sec").value : DEFAULT_DATE.sec
		}
		let nowDate = new Date();
		let now = {
			milliSec: nowDate.getMilliseconds(),
			sec: nowDate.getSeconds(),
			min: nowDate.getMinutes(),
			hour: nowDate.getHours(),
			day: nowDate.getDate(),
			month: nowDate.getMonth() + 1,
			year: nowDate.getFullYear()
		};
		function getInputDate() {
			inputDate.year = el("year").value ? el("year").value : DEFAULT_DATE.year;
			inputDate.month = el("month").value ? el("month").value : DEFAULT_DATE.month;
			inputDate.day = el("day").value ? el("day").value : DEFAULT_DATE.day;
			inputDate.hour = el("hour").value ? el("hour").value : DEFAULT_DATE.hour;
			inputDate.min = el("min").value ? el("min").value : DEFAULT_DATE.min;
			inputDate.sec = el("sec").value ? el("sec").value : DEFAULT_DATE.sec;
		}
		function getNowDate() {
			nowDate = new Date();
			now.milliSec = nowDate.getMilliseconds();
			now.sec = nowDate.getSeconds();
			now.min = nowDate.getMinutes();
			now.hour = nowDate.getHours();
			now.day = nowDate.getDate();
			now.month = nowDate.getMonth() + 1;
			now.year = nowDate.getFullYear();
		};
		setTimeout(() => {
			setInterval(function()  {
				getInputDate();
				getNowDate();
				el("titleOutput").innerHTML = `now: ${now.year}/${now.month}/${now.day} ${now.hour}:${now.min}:${now.sec}.${now.milliSec}`;
				let timeLeft = {
					year: inputDate.year - now.year,
					month: inputDate.month - now.month,
					day: inputDate.day - now.day,
					hour: inputDate.hour - now.hour,
					min: inputDate.min - now.min,
					sec: inputDate.sec - now.sec
				};
				for(let i=0;i<Object.keys(timeLeft).length;i++) {
					const key = Object.keys(timeLeft)[i];
					// keyãŒ"year"ã®ã¨ãã‚‚è€ƒæ…®ã—ãªãã‚ƒ
					if(timeLeft[key] < 0) {
						timeLeft[Object.keys(timeLeft)[i-1]] -= 1;
						timeLeft[key] += Object.values(MAX_VALUE)[i]
					};
				};
				el("numberOutput").innerText = timeLeft.year + "å¹´" + timeLeft.month + "æœˆ" + timeLeft.day + "æ—¥ " + timeLeft.hour + "æ™‚" + timeLeft.min + "åˆ†" + timeLeft.sec + "ç§’";
			}, 1000);
		},1000 - now.milliSec);
	}catch(error) {console.log(`${error.name}\n${error.stack}`)};
	</script>
</body>
</html>